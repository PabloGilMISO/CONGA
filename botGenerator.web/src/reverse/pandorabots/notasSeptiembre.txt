Nota para la vuelta de vacaciones:

Tengo que reinventar la forma en que se leen los flujos porque está mal planteada. Quizá lo mejor sea empezarla de 0 porque puede ser bastante lioso tocar dentro de las funciones que hay creadas.

Planteo desarrollar la recogida de flows en dos fases:

Fase 1: Recogida de flows sencillos.

Flow
| Intent.text = category.pattern
| Target.actions[] = category.template.getResponses()

Fase 2: Recogida de flows complejos (outcomings)

Una vez recogidos los flows sencillos, se van tomando sus that asociados (se pueden guardar los flows sencillos como Map<Flow, String> donde String es el that asociado a esa category) y se van buscando los flows a los que añadir estos flows en forma de outcomings.

Finalmente se mantendrán los flows que no tengan that asociado y aquellos que tengan outcoming, borrando aquellos que tienen that asociado de la lista inicial.

Se cogerían los flows de la lista con valores del map "" y los nuevos generados con outcomings.

Quizá habría que plantear la función de forma recursiva desde que puede haber flujos de intents de profundidad variable.